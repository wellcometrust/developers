"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function getRouteRegex(normalizedRoute) {
    const escapedRoute = (normalizedRoute.replace(/\/$/, '') || '/').replace(/[|\\{}()[\]^$+*?.-]/g, '\\$&');
    const groups = {};
    let groupIndex = 1;
    const parameterizedRoute = escapedRoute.replace(/\/\\\$([^\/]+?)(?=\/|$)/g, (_, $1) => ((groups[$1
        // // Remove optional parameter marker
        // .replace(/\\\$$/, '')
        // Un-escape key
        .replace(/\\([|\\{}()[\]^$+*?.-])/g, '$1')] = groupIndex++),
        // // Test the route for an optional parameter
        // $1.lastIndexOf('$') === $1.length - 1
        //   ? // Optional: match a param
        //     '(?:/([^/]+?))?'
        //   : // Required: match a param
        '/([^/]+?)'));
    return {
        re: new RegExp('^' + parameterizedRoute + '(?:/)?$', 'i'),
        groups,
    };
}
exports.getRouteRegex = getRouteRegex;
